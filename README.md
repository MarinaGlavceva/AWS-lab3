# Лабораторная работа: Создание виртуальной сети (VPC) в AWS

## **Цель моей работы**

В рамках данной лабораторной работы я вручную создала виртуальную сеть (VPC) в AWS и настроила полноценную сетевую инфраструктуру, включающую:

* виртуальную частную сеть (VPC),
* публичные и приватные подсети,
* интернет-шлюз (Internet Gateway),
* NAT Gateway,
* отдельные таблицы маршрутов,
* группы безопасности (Security Groups),
* три EC2-инстанса: веб-сервер, bastion-host и сервер базы данных.

В процессе выполнения я научилась:

* понимать принципы сетевой изоляции в AWS,
* настраивать маршрутизацию между подсетями,
* управлять входящими и исходящими соединениями через Security Groups,
* пользоваться bastion-хостом для доступа в приватную подсеть,
* развертывать EC2-инстансы с автоматической установкой ПО.


#  **Описание созданной мной архитектуры**

В результате работы мной была развёрнута следующая сеть:

* **VPC**, внутри которой изолированы все ресурсы.
* **Публичная подсеть** — для веб-сервера и bastion-host.
* **Приватная подсеть** — для сервера базы данных.
* **Internet Gateway** — обеспечивает доступ в интернет для публичной подсети.
* **NAT Gateway** — даёт приватной подсети исходящий доступ в интернет.
* **Две таблицы маршрутов** — отдельная для публичной и приватной подсети.
* **Security Groups** — три группы с разными уровнями разрешений.
* **EC2-инстансы**:

  * Web-server (публичная подсеть)
  * Bastion-host (публичная подсеть)
  * DB-server (приватная подсеть)


#  **Ход выполнения работы**


# 1. Подготовка среды

Я вошла в AWS Management Console, переключила регион на **Frankfurt (eu-central-1)** и открыла сервис **VPC**.

# 2. Создание VPC

Я создала VPC со следующими параметрами:

* **Name:** `student-vpc-kXX`
* **CIDR блок:** `10.(k%30).0.0/16`
* **Tenancy:** Default
<img width="1280" height="388" alt="Image" src="https://github.com/user-attachments/assets/a7f4b3f2-b904-4ca5-a4c7-81f113d13b18" />

### Ответ на контрольный вопрос

**Маска /16** означает, что сеть содержит ~65 536 адресов.
Использовать `/8` нельзя — это слишком большая сеть и выходит за общепринятые рекомендации AWS.


# 3. Создание Internet Gateway (IGW)

Я создала IGW `student-igw-kXX` и прикрепила его к моей VPC.
С этого момента подсети внутри VPC могут получать доступ в интернет (если маршрутизация настроена правильно).

<img width="953" height="664" alt="Image" src="https://github.com/user-attachments/assets/15a3e640-c17b-4d3c-aef4-37115e23a761" />

# 4. Создание подсетей

## 4.1 Публичная подсеть

* **Name:** `public-subnet-kXX`
* **CIDR:** `10.(k%30).1.0/24`
* **AZ:** eu-central-1a
<img width="1280" height="245" alt="Image" src="https://github.com/user-attachments/assets/29ee0d99-88f9-4ae6-b839-3d66a743bd58" />
###  Ответ на контрольный вопрос

На данном этапе подсеть НЕ является публичной, потому что маршруты ещё не направлены в Internet Gateway.

## 4.2 Приватная подсеть

* **Name:** `private-subnet-kXX`
* **CIDR:** `10.(k%30).2.0/24`
* **AZ:** eu-central-1b
<img width="891" height="783" alt="Image" src="https://github.com/user-attachments/assets/f49b7125-b123-47cf-9bda-94843436178a" />

### Ответ на контрольный вопрос

Приватная подсеть пока тоже не приватная. Она станет приватной только после настройки таблицы маршрутов и отсутствия публичных IP на инстансах.

# 5. Создание таблиц маршрутов

## Публичная таблица маршрутов

* **Name:** `public-rt-kXX`
* Я добавила маршрут:

  * `0.0.0.0/0` → **Internet Gateway**
* Ассоциировала таблицу с `public-subnet-kXX`

Теперь публичная подсеть получила выход в интернет.

### Контрольный вопрос

Я привязываю таблицу маршрутов к подсети, чтобы подсеть использовала заданные маршруты, а не маршруты по умолчанию.

## Приватная таблица маршрутов

* **Name:** `private-rt-kXX`
* Ассоциирована с `private-subnet-kXX`

Пока что приватная подсеть не имеет доступа в интернет — NAT Gateway ещё не создан.

# 6. Создание NAT Gateway

## 6.1 Создание Elastic IP

Я создала новый статический публичный IP (Elastic IP).

## 6.2 Создание NAT Gateway

* **Name:** `nat-gateway-kXX`
* Размещён в публичной подсети
* Выбрана режим "Zonal"
* К NAT привязан Elastic IP

После нескольких минут NAT стал доступным.

## 6.3 Настройка маршрутов приватной таблицы

В `private-rt-kXX` я добавила:

* `0.0.0.0/0` → **NAT Gateway**

Теперь приватная подсеть имеет доступ в интернет, но остаётся недоступной извне.

### Контрольный вопрос: как работает NAT Gateway?

Он подменяет исходящие запросы приватных инстансов своим публичным IP, скрывая внутренние адреса и запрещая внешние подключения.

# 7. Создание Security Groups

Я создала три группы безопасности:

### **web-sg-kXX:**

Разрешила вход:

* HTTP (80) — всему миру
* HTTPS (443) — всему миру

### **bastion-sg-kXX:**

Разрешила вход:

* SSH (22) — **только с моего IP**

### **db-sg-kXX:**

Разрешила:

* MySQL (3306) — от web-sg-kXX
* MySQL (3306) — от bastion-sg-kXX
* SSH — только от bastion-host

###  Контрольный вопрос: кто такой Bastion Host?

Это промежуточный защищённый сервер, через который можно подключаться к ресурсам в приватной подсети.

# 8. Создание EC2-инстансов

## Web-server

* Размещён в публичной подсети
* Получил публичный IP
* Применена группа безопасности web-sg
* В User Data установился Apache и PHP-файл `phpinfo()`

## DB-server

* Размещён в приватной подсети
* Публичного IP нет
* Установлена MariaDB
* root-пароль был изменён

## Bastion-host

* Размещён в публичной подсети
* Использует группу безопасности с SSH-доступом
* Через него я подключалась в приватную подсеть

# 9. Проверка работы

Я выполнила:

###  Проверку веб-сервера

В браузере открылась страница phpinfo().

###  Подключение к bastion-host по SSH

Работает корректно.

###  Проверка интернета внутри bastion

Команда `ping google.com` возвращала ответы — значит IGW и маршруты настроены правильно.

###  Подключение к базе данных с bastion

Команда:

```bash
mysql -h <private-ip-db> -u root -p
```

позволила подключиться к MariaDB, что подтверждает правильность конфигурации приватной подсети и NAT Gateway.

---

# 10. Завершение работы и удаление ресурсов

Чтобы предотвратить расходы, я удалила:

* все EC2-инстансы,
* NAT Gateway,
* Elastic IP.

После этого я вручную удалила:

* ассоциации таблиц маршрутов,
* сами таблицы маршрутов,
* подсети,
* Security Groups,
* Internet Gateway,
* VPC.

Все ресурсы были успешно удалены в корректном порядке.

#  Итоги

По завершению работы я:

* успешно создала и настроила изолированную архитектуру AWS VPC,
* настроила публичные и приватные подсети,
* обеспечила доступ в интернет с помощью IGW и NAT,
* настроила доступ к приватной подсети через bastion-host,
* развернула и проверила взаимодействие EC2-инстансов,
* корректно освободила ресурсы.

Я полностью выполнила лабораторную работу и получила практический опыт создания сетевой инфраструктуры в AWS.


✨ сделать PDF-версию отчёта
✨ добавить схему VPC в виде картинки
✨ оформить его как документ Word

Скажи слово — сделаю!
